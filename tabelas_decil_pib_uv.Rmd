---
title: "Teste PIB"
author: "Caroline Fabrin"
date: "29/08/2021"
output:
  html_document:
    df_print: paged
  word_document:
    reference_docx: modelo.docx
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```


```{r include=FALSE}
library(readr)
library(tidyverse)  
## Load sandwich package for robust estimator of glm
library(sandwich)
## Load lmtest package for coeftest of glm
library(lmtest)
library(finalfit)
library(reshape2)
library(gridExtra)
library(cowplot)
library(kableExtra)
library(flextable)
library(lubridate)
library(reshape2)
library(pander)

```


```{r include=FALSE}

base_inter <- read_csv("bases/base_inter_decil.csv")


```

```{r include=FALSE}

base_inter <- subset(base_inter, base_inter$EVOLUCAO %in% c(1,2))
base_inter <- subset(base_inter, base_inter$AMOSTRA %in% c(1,2))
base_inter <- subset(base_inter, base_inter$UTI %in% c(1,2))
base_inter <- subset(base_inter, base_inter$SUPORT_VEN %in% c(1,2,3))



base_inter$OBITO <- ifelse(base_inter$EVOLUCAO == 2, 1,0)  #Coluna de óbito: 0 = NÃO ÕBITO, 1 = ÕBITO
base_inter$AMOSTRA <- ifelse(base_inter$AMOSTRA == 1, 1,0) #Coluna de coleta de amostra: 0 = NÃO COLETOU; 1 = COLETOU
base_inter$DT_RAIOX <- ifelse(is.na(base_inter$DT_RAIOX), 0,1) #Coluna Rx: 0 = NÃO FEZ; 1 = FEZ
base_inter$DT_TOMO <- ifelse(is.na(base_inter$DT_TOMO), 0,1) #Coluna Tomo: 0 = NÃO FEZ; 1 = FEZ
base_inter$UTI <- ifelse(base_inter$UTI == 1, 1,0) #Coluna de UTI: 0 = NÃO UTI; 1 = UTI
base_inter$SUPORT_VEN_TOT <- ifelse(base_inter$SUPORT_VEN %in% c(1,2), 1,0) #Coluna de suporte ventilatóro: 0 = NÃO; 1 = SIM
base_inter$SUPORT_VEN_INVA <- ifelse(base_inter$SUPORT_VEN %in% c(1), 1,0) #Coluna de suporte ventilatóro invasivo: 0 = NÃO; 1 = SIM
base_inter$SUPORT_VEN_N_INVA <- ifelse(base_inter$SUPORT_VEN %in% c(2), 1,0) #Coluna de suporte ventilatóro invasivo: 0 = NÃO; 1 = SIM

base_inter$`Decil` <- as.factor(base_inter$`Decil`)


#Internações
idade_0_11_inter_cca <- subset(base_inter, IDADE < 12)

idade_12_18_inter_adolesc <- subset(base_inter, IDADE >= 12)

#Ordenando fatores##
idade_0_11_inter_cca$REGIAO <- factor(idade_0_11_inter_cca$REGIAO, c("NORDESTE", "NORTE", "CENTRO-OESTE", "SUL", "SUDESTE"))
idade_12_18_inter_adolesc$REGIAO <- factor(idade_12_18_inter_adolesc$REGIAO, c("NORDESTE", "NORTE", "CENTRO-OESTE", "SUL", "SUDESTE"))

#Primeira onda## 10 a 43 em 2020
idade_0_11_1onda_cca  <- subset(idade_0_11_inter_cca,
                                idade_0_11_inter_cca$DT_SIN_PRI >= as.Date("2020-03-03") &
                                idade_0_11_inter_cca$DT_SIN_PRI < as.Date("2020-10-24"))
idade_0_11_1onda_cca$DT_SIN_PRI <- epiweek(idade_0_11_1onda_cca$DT_SIN_PRI)


idade_12_18_1onda_adolesc  <- subset(idade_12_18_inter_adolesc,
                                     idade_12_18_inter_adolesc$DT_SIN_PRI >= as.Date("2020-03-03") &                                          idade_12_18_inter_adolesc$DT_SIN_PRI < as.Date("2020-10-24"))
idade_12_18_1onda_adolesc$DT_SIN_PRI <- epiweek(idade_12_18_1onda_adolesc$DT_SIN_PRI)


##Segunda onda## 44 em 2020 à semana 21 em 2021
idade_0_11_2onda_cca  <- subset(idade_0_11_inter_cca,
                                idade_0_11_inter_cca$DT_SIN_PRI >= as.Date("2020-10-25") &
                                idade_0_11_inter_cca$DT_SIN_PRI < as.Date("2021-05-29"))
idade_0_11_2onda_cca$DT_SIN_PRI <- epiweek(idade_0_11_2onda_cca$DT_SIN_PRI)


idade_12_18_2onda_adolesc  <- subset(idade_12_18_inter_adolesc,
                                     idade_12_18_inter_adolesc$DT_SIN_PRI >= as.Date("2020-10-25") &                                          idade_12_18_inter_adolesc$DT_SIN_PRI < as.Date("2021-05-29"))
idade_12_18_2onda_adolesc$DT_SIN_PRI <- epiweek(idade_12_18_2onda_adolesc$DT_SIN_PRI)


##Bases salvas# 

write.csv(base_inter, "bases/base_inter.csv", row.names = F)

write.csv(idade_0_11_inter_cca, "bases/idade_0_11_inter_cca.csv", row.names = F)

write.csv(idade_12_18_inter_adolesc, "bases/idade_12_18_inter_adolesc.csv", row.names = F)


write.csv(idade_0_11_1onda_cca,"bases/idade_0_11_1onda_cca.csv", row.names = F)

write.csv(idade_0_11_2onda_cca, "bases/idade_0_11_2onda_cca.csv", row.names = F)

write.csv(idade_12_18_1onda_adolesc,"bases/idade_12_18_1onda_adolesc.csv", row.names = F)

write.csv(idade_12_18_2onda_adolesc, "bases/idade_12_18_2onda_adolesc.csv", row.names = F)

```


```{r include=FALSE}

###########################################################################
#Função para estimação
###########################################################################
#Estimando relações - http://rstudio-pubs-static.s3.amazonaws.com/5752_fc41dca85dd24539bc99868697de83d0.html
esimativa_rr <- function(variavel, base){
  glm.regre <- glm(variavel ~ `Decil`, family="poisson"(link = "log"), data = base)
  ## Poisson model with SE estimated via robust variance estimator
  se_robusto <- coeftest(glm.regre, vcov = sandwich)
  ## Risk ratio (intercept and IC 95%) 
  plot <- cbind(exp(coef(se_robusto)), exp(confint(se_robusto))) %>% as.data.frame()
  table <-cbind(exp(coef(se_robusto)), exp(confint(se_robusto))) %>% as.data.frame()
  table$`Est (IC 95%)` <- paste0(round(table$V1,2), " (", round(table$`2.5 %`,2),"-",round(table$`97.5 %`,2),")")
  resultado <- list(glm.regre,table, plot)
  return(resultado)
  
}



esimativa_rr2 <- function(variavel, base){
  glm.regre <- glm(variavel ~ `REGIAO`, family="poisson"(link = "log"), data = base)
  ## Poisson model with SE estimated via robust variance estimator
  se_robusto <- coeftest(glm.regre, vcov = sandwich)
  ## Risk ratio (intercept and IC 95%) 
  plot <- cbind(exp(coef(se_robusto)), exp(confint(se_robusto))) %>% as.data.frame()
  table <-cbind(exp(coef(se_robusto)), exp(confint(se_robusto))) %>% as.data.frame()
  table$`Est (IC 95%)` <- paste0(round(table$V1,2), " (", round(table$`2.5 %`,2),"-",round(table$`97.5 %`,2),")")
  resultado <- list(glm.regre,table, plot)
  return(resultado)
  
}

```


```{r include=FALSE}

###########################################################################
#Internados por PIB 
###########################################################################
idade_0_11_inter_amostra <- esimativa_rr(idade_0_11_inter_cca$AMOSTRA, idade_0_11_inter_cca)
idade_0_11_inter_raio_x <- esimativa_rr(idade_0_11_inter_cca$DT_RAIOX, idade_0_11_inter_cca)
idade_0_11_inter_tomo <- esimativa_rr(idade_0_11_inter_cca$DT_TOMO, idade_0_11_inter_cca)
idade_0_11_inter_vent <- esimativa_rr(idade_0_11_inter_cca$SUPORT_VEN_TOT, idade_0_11_inter_cca)
idade_0_11_inter_vent_inva <- esimativa_rr(idade_0_11_inter_cca$SUPORT_VEN_INVA, idade_0_11_inter_cca)
idade_0_11_inter_vent_n_inva <- esimativa_rr(idade_0_11_inter_cca$SUPORT_VEN_N_INVA, idade_0_11_inter_cca)
idade_0_11_inter_uti <- esimativa_rr(idade_0_11_inter_cca$UTI, idade_0_11_inter_cca)
idade_0_11_inter_obito <- esimativa_rr(idade_0_11_inter_cca$OBITO, idade_0_11_inter_cca)


idade_12_18_inter_amostra <- esimativa_rr(idade_12_18_inter_adolesc$AMOSTRA, idade_12_18_inter_adolesc)
idade_12_18_inter_raio_x <- esimativa_rr(idade_12_18_inter_adolesc$DT_RAIOX, idade_12_18_inter_adolesc)
idade_12_18_inter_tomo <- esimativa_rr(idade_12_18_inter_adolesc$DT_TOMO, idade_12_18_inter_adolesc)
idade_12_18_inter_vent <- esimativa_rr(idade_12_18_inter_adolesc$SUPORT_VEN_TOT, idade_12_18_inter_adolesc)
idade_12_18_inter_vent_inva <- esimativa_rr(idade_12_18_inter_adolesc$SUPORT_VEN_INVA, idade_12_18_inter_adolesc)
idade_12_18_inter_vent_n_inva <- esimativa_rr(idade_12_18_inter_adolesc$SUPORT_VEN_N_INVA, idade_12_18_inter_adolesc)
idade_12_18_inter_uti <- esimativa_rr(idade_12_18_inter_adolesc$UTI, idade_12_18_inter_adolesc)
idade_12_18_inter_obito <- esimativa_rr(idade_12_18_inter_adolesc$OBITO, idade_12_18_inter_adolesc)

inter_0_11 <- data.frame(idade_0_11_inter_amostra[[2]][4],
          idade_0_11_inter_raio_x[[2]][4],
          idade_0_11_inter_tomo[[2]][4],
          idade_0_11_inter_vent[[2]][4],
          idade_0_11_inter_vent_inva[[2]][4],
          idade_0_11_inter_vent_n_inva[[2]][4],
          idade_0_11_inter_uti[[2]][4],
          idade_0_11_inter_obito[[2]][4])
names(inter_0_11) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")


write.csv(idade_0_11_inter_obito[[2]][1], "bases/idade_0_11_inter_obito.csv", row.names = F)

inter_12_18 <- data.frame(idade_12_18_inter_amostra[[2]][4],
          idade_12_18_inter_raio_x[[2]][4],
          idade_12_18_inter_tomo[[2]][4],
          idade_12_18_inter_vent[[2]][4],
          idade_12_18_inter_vent_inva[[2]][4],
          idade_12_18_inter_vent_n_inva[[2]][4],
          idade_12_18_inter_uti[[2]][4],
          idade_12_18_inter_obito[[2]][4])

names(inter_12_18) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")


write.csv(idade_12_18_inter_obito[[2]][1], "bases/idade_12_18_inter_obito.csv", row.names = F)

inter <- rbind(inter_0_11, inter_12_18) %>% as.data.frame()


```




```{r include=FALSE}

###########################################################################
#Internados por PIB - PRIMEIRA ONDA

#Calculo letalidade - PRIMEIRA ONDA
idade_0_11_1onda_caso <- idade_0_11_1onda_cca %>%
 group_by(Decil) %>%
  summarise(CASO = sum(CASO, na.rm = T),
  sum(idade_0_11_1onda_cca$CASO))
idade_0_11_1onda_caso$TAXA <- (idade_0_11_1onda_caso$CASO/ sum(idade_0_11_1onda_cca$CASO))*100

idade_0_11_1onda_letalidade <- subset(idade_0_11_1onda_cca, idade_0_11_1onda_cca$OBITO == 1)
sum(idade_0_11_1onda_letalidade$CASO)


idade_0_11_1onda_amostra <- esimativa_rr(idade_0_11_1onda_cca$AMOSTRA, idade_0_11_1onda_cca)
idade_0_11_1onda_raio_x <- esimativa_rr(idade_0_11_1onda_cca$DT_RAIOX, idade_0_11_1onda_cca)
idade_0_11_1onda_tomo <- esimativa_rr(idade_0_11_1onda_cca$DT_TOMO, idade_0_11_1onda_cca)
idade_0_11_1onda_vent <- esimativa_rr(idade_0_11_1onda_cca$SUPORT_VEN_TOT, idade_0_11_1onda_cca)
idade_0_11_1onda_vent_inva <- esimativa_rr(idade_0_11_1onda_cca$SUPORT_VEN_INVA, idade_0_11_1onda_cca)
idade_0_11_1onda_vent_n_inva <- esimativa_rr(idade_0_11_1onda_cca$SUPORT_VEN_N_INVA, idade_0_11_1onda_cca)
idade_0_11_1onda_uti <- esimativa_rr(idade_0_11_1onda_cca$UTI, idade_0_11_1onda_cca)
idade_0_11_1onda_obito <- esimativa_rr(idade_0_11_1onda_cca$OBITO, idade_0_11_1onda_cca)


#Calculo letalidade - PRIMEIRA ONDA
idade_12_18_1onda_caso <- idade_12_18_1onda_adolesc %>%
 group_by(Decil) %>%
  summarise(CASO = sum(CASO, na.rm = T),
  sum(idade_12_18_1onda_adolesc$CASO))
idade_12_18_1onda_caso$TAXA <- (idade_12_18_1onda_caso$CASO/ sum(idade_12_18_1onda_adolesc$CASO))*100

idade_12_18_1onda_letalidade <- subset(idade_12_18_1onda_adolesc, idade_12_18_1onda_adolesc$OBITO == 1)
sum(idade_12_18_1onda_letalidade$CASO)


idade_12_18_1onda_caso <- esimativa_rr(idade_12_18_1onda_adolesc$CASO, idade_12_18_1onda_adolesc)
idade_12_18_1onda_amostra <- esimativa_rr(idade_12_18_1onda_adolesc$AMOSTRA, idade_12_18_1onda_adolesc)
idade_12_18_1onda_raio_x <- esimativa_rr(idade_12_18_1onda_adolesc$DT_RAIOX, idade_12_18_1onda_adolesc)
idade_12_18_1onda_tomo <- esimativa_rr(idade_12_18_1onda_adolesc$DT_TOMO, idade_12_18_1onda_adolesc)
idade_12_18_1onda_vent <- esimativa_rr(idade_12_18_1onda_adolesc$SUPORT_VEN_TOT, idade_12_18_1onda_adolesc)
idade_12_18_1onda_vent_inva <- esimativa_rr(idade_12_18_1onda_adolesc$SUPORT_VEN_INVA, idade_12_18_1onda_adolesc)
idade_12_18_1onda_vent_n_inva <- esimativa_rr(idade_12_18_1onda_adolesc$SUPORT_VEN_N_INVA, idade_12_18_1onda_adolesc)
idade_12_18_1onda_uti <- esimativa_rr(idade_12_18_1onda_adolesc$UTI, idade_12_18_1onda_adolesc)
idade_12_18_1onda_obito <- esimativa_rr(idade_12_18_1onda_adolesc$OBITO, idade_12_18_1onda_adolesc)

onda_0_11 <- data.frame(
          idade_0_11_1onda_amostra[[2]][4],
          idade_0_11_1onda_raio_x[[2]][4],
          idade_0_11_1onda_tomo[[2]][4],
          idade_0_11_1onda_vent[[2]][4],
          idade_0_11_1onda_vent_inva[[2]][4],
          idade_0_11_1onda_vent_n_inva[[2]][4],
          idade_0_11_1onda_uti[[2]][4],
          idade_0_11_1onda_obito[[2]][4])

write.csv(idade_0_11_1onda_obito[[2]][1], "bases/idade_0_11_1onda_obito.csv", row.names = F)

names(onda_0_11) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")


onda_12_18 <- data.frame(idade_12_18_1onda_amostra[[2]][4],
          idade_12_18_1onda_raio_x[[2]][4],
          idade_12_18_1onda_tomo[[2]][4],
          idade_12_18_1onda_vent[[2]][4],
          idade_12_18_1onda_vent_inva[[2]][4],
          idade_12_18_1onda_vent_n_inva[[2]][4],
          idade_12_18_1onda_uti[[2]][4],
          idade_12_18_1onda_obito[[2]][4])

names(onda_12_18) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")



write.csv(idade_12_18_1onda_obito[[2]][1], "bases/idade_12_18_1onda_obito.csv", row.names = F)

onda <- rbind(onda_0_11, onda_12_18) %>% as.data.frame()



```


```{r include=FALSE}

###########################################################################
#Internados por PIB - SEGUNDA  ONDA


#Calculo letalidade - SEGUNDA ONDA
idade_0_11_2onda_caso <- idade_0_11_2onda_cca %>%
 group_by(Decil) %>%
  summarise(CASO = sum(CASO, na.rm = T),
  sum(idade_0_11_2onda_cca$CASO))
idade_0_11_2onda_caso$TAXA <- (idade_0_11_2onda_caso$CASO/ sum(idade_0_11_2onda_cca$CASO))*100

idade_0_11_2onda_letalidade <- subset(idade_0_11_2onda_cca, idade_0_11_2onda_cca$OBITO == 1)
sum(idade_0_11_2onda_letalidade$CASO)


idade_0_11_2onda_amostra <- esimativa_rr(idade_0_11_2onda_cca$AMOSTRA, idade_0_11_2onda_cca)
idade_0_11_2onda_raio_x <- esimativa_rr(idade_0_11_2onda_cca$DT_RAIOX, idade_0_11_2onda_cca)
idade_0_11_2onda_tomo <- esimativa_rr(idade_0_11_2onda_cca$DT_TOMO, idade_0_11_2onda_cca)
idade_0_11_2onda_vent <- esimativa_rr(idade_0_11_2onda_cca$SUPORT_VEN_TOT, idade_0_11_2onda_cca)
idade_0_11_2onda_vent_inva <- esimativa_rr(idade_0_11_2onda_cca$SUPORT_VEN_INVA, idade_0_11_2onda_cca)
idade_0_11_2onda_vent_n_inva <- esimativa_rr(idade_0_11_2onda_cca$SUPORT_VEN_N_INVA, idade_0_11_2onda_cca)
idade_0_11_2onda_uti <- esimativa_rr(idade_0_11_2onda_cca$UTI, idade_0_11_2onda_cca)
idade_0_11_2onda_obito <- esimativa_rr(idade_0_11_2onda_cca$OBITO, idade_0_11_2onda_cca)


#Calculo letalidade - SEGUNDA ONDA
idade_12_18_2onda_caso <- idade_12_18_2onda_adolesc %>%
 group_by(Decil) %>%
  summarise(CASO = sum(CASO, na.rm = T),
  sum(idade_12_18_2onda_adolesc$CASO))
idade_12_18_2onda_caso$TAXA <- (idade_12_18_2onda_caso$CASO/ sum(idade_12_18_2onda_adolesc$CASO))*100

idade_12_18_2onda_letalidade <- subset(idade_12_18_2onda_adolesc, idade_12_18_2onda_adolesc$OBITO == 1)
sum(idade_12_18_2onda_letalidade$CASO)


idade_12_18_2onda_amostra <- esimativa_rr(idade_12_18_2onda_adolesc$AMOSTRA, idade_12_18_2onda_adolesc)
idade_12_18_2onda_raio_x <- esimativa_rr(idade_12_18_2onda_adolesc$DT_RAIOX, idade_12_18_2onda_adolesc)
idade_12_18_2onda_tomo <- esimativa_rr(idade_12_18_2onda_adolesc$DT_TOMO, idade_12_18_2onda_adolesc)
idade_12_18_2onda_vent <- esimativa_rr(idade_12_18_2onda_adolesc$SUPORT_VEN_TOT, idade_12_18_2onda_adolesc)
idade_12_18_2onda_vent_inva <- esimativa_rr(idade_12_18_2onda_adolesc$SUPORT_VEN_INVA, idade_12_18_2onda_adolesc)
idade_12_18_2onda_vent_n_inva <- esimativa_rr(idade_12_18_2onda_adolesc$SUPORT_VEN_N_INVA, idade_12_18_2onda_adolesc)
idade_12_18_2onda_uti <- esimativa_rr(idade_12_18_2onda_adolesc$UTI, idade_12_18_2onda_adolesc)
idade_12_18_2onda_obito <- esimativa_rr(idade_12_18_2onda_adolesc$OBITO, idade_12_18_2onda_adolesc)

seg_onda_0_11 <- data.frame(idade_0_11_2onda_amostra[[2]][4],
          idade_0_11_2onda_raio_x[[2]][4],
          idade_0_11_2onda_tomo[[2]][4],
          idade_0_11_2onda_vent[[2]][4],
          idade_0_11_2onda_vent_inva[[2]][4],
          idade_0_11_2onda_vent_n_inva[[2]][4],
          idade_0_11_2onda_uti[[2]][4],
          idade_0_11_2onda_obito[[2]][4])
names(seg_onda_0_11) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")


write.csv(idade_0_11_2onda_obito[[2]][1], "bases/idade_0_11_2onda_obito.csv", row.names = F)

seg_onda_12_18 <- data.frame(idade_12_18_2onda_amostra[[2]][4],
          idade_12_18_2onda_raio_x[[2]][4],
          idade_12_18_2onda_tomo[[2]][4],
          idade_12_18_2onda_vent[[2]][4],
          idade_12_18_2onda_vent_inva[[2]][4],
          idade_12_18_2onda_vent_n_inva[[2]][4],
          idade_12_18_2onda_uti[[2]][4],
          idade_12_18_2onda_obito[[2]][4])

names(seg_onda_12_18) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")


write.csv(idade_12_18_2onda_obito[[2]][1], "bases/idade_12_18_2onda_obito.csv", row.names = F)

seg_onda <- rbind(seg_onda_0_11, seg_onda_12_18) %>% as.data.frame()



```



```{r include=FALSE}

###########################################################################
#Internados por REGIÕES
###########################################################################
idade_0_11_regiao_amostra <- esimativa_rr2(idade_0_11_inter_cca$AMOSTRA, idade_0_11_inter_cca)
idade_0_11_regiao_raio_x <- esimativa_rr2(idade_0_11_inter_cca$DT_RAIOX, idade_0_11_inter_cca)
idade_0_11_regiao_tomo <- esimativa_rr2(idade_0_11_inter_cca$DT_TOMO, idade_0_11_inter_cca)
idade_0_11_regiao_vent <- esimativa_rr2(idade_0_11_inter_cca$SUPORT_VEN_TOT, idade_0_11_inter_cca)
idade_0_11_regiao_vent_inva <- esimativa_rr2(idade_0_11_inter_cca$SUPORT_VEN_INVA, idade_0_11_inter_cca)
idade_0_11_regiao_vent_n_inva <- esimativa_rr2(idade_0_11_inter_cca$SUPORT_VEN_N_INVA, idade_0_11_inter_cca)
idade_0_11_regiao_uti <- esimativa_rr2(idade_0_11_inter_cca$UTI, idade_0_11_inter_cca)
idade_0_11_regiao_obito <- esimativa_rr2(idade_0_11_inter_cca$OBITO, idade_0_11_inter_cca)


idade_12_18_regiao_amostra <- esimativa_rr2(idade_12_18_inter_adolesc$AMOSTRA, idade_12_18_inter_adolesc)
idade_12_18_regiao_raio_x <- esimativa_rr2(idade_12_18_inter_adolesc$DT_RAIOX, idade_12_18_inter_adolesc)
idade_12_18_regiao_tomo <- esimativa_rr2(idade_12_18_inter_adolesc$DT_TOMO, idade_12_18_inter_adolesc)
idade_12_18_regiao_vent <- esimativa_rr2(idade_12_18_inter_adolesc$SUPORT_VEN_TOT, idade_12_18_inter_adolesc)
idade_12_18_regiao_vent_inva <- esimativa_rr2(idade_12_18_inter_adolesc$SUPORT_VEN_INVA, idade_12_18_inter_adolesc)
idade_12_18_regiao_vent_n_inva <- esimativa_rr2(idade_12_18_inter_adolesc$SUPORT_VEN_N_INVA, idade_12_18_inter_adolesc)
idade_12_18_regiao_uti <- esimativa_rr2(idade_12_18_inter_adolesc$UTI, idade_12_18_inter_adolesc)
idade_12_18_regiao_obito <- esimativa_rr2(idade_12_18_inter_adolesc$OBITO, idade_12_18_inter_adolesc)

regiao_0_11 <- data.frame(idade_0_11_regiao_amostra[[2]][4],
          idade_0_11_regiao_raio_x[[2]][4],
          idade_0_11_regiao_tomo[[2]][4],
          idade_0_11_regiao_vent[[2]][4],
          idade_0_11_regiao_vent_inva[[2]][4],
          idade_0_11_regiao_vent_n_inva[[2]][4],
          idade_0_11_regiao_uti[[2]][4],
          idade_0_11_regiao_obito[[2]][4])
names(regiao_0_11) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")


regiao_12_18 <- data.frame(idade_12_18_regiao_amostra[[2]][4],
          idade_12_18_regiao_raio_x[[2]][4],
          idade_12_18_regiao_tomo[[2]][4],
          idade_12_18_regiao_vent[[2]][4],
          idade_12_18_regiao_vent_inva[[2]][4],
          idade_12_18_regiao_vent_n_inva[[2]][4],
          idade_12_18_regiao_uti[[2]][4],
          idade_12_18_regiao_obito[[2]][4])

names(regiao_12_18) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")


regiao <- rbind(regiao_0_11, regiao_12_18) %>% as.data.frame()

write.csv(regiao, "bases/regiao.csv", row.names = T)

```




```{r include=FALSE}

###########################################################################
#Internados por REGIÕES - PRIMEIRA ONDA

#Calculo INCIDENCIA - PRIMEIRA ONDA
idade_0_11_1onda_regiao_caso <- idade_0_11_1onda_cca %>%
 group_by(REGIAO) %>%
  summarise(CASO = sum(CASO, na.rm = T),
  sum(idade_0_11_1onda_cca$CASO))
idade_0_11_1onda_regiao_caso$TAXA <- (idade_0_11_1onda_regiao_caso$CASO/ sum(idade_0_11_1onda_cca$CASO))*100



idade_0_11_1onda_regiao_amostra <- esimativa_rr2(idade_0_11_1onda_cca$AMOSTRA, idade_0_11_1onda_cca)
idade_0_11_1onda_regiao_raio_x <- esimativa_rr2(idade_0_11_1onda_cca$DT_RAIOX, idade_0_11_1onda_cca)
idade_0_11_1onda_regiao_tomo <- esimativa_rr2(idade_0_11_1onda_cca$DT_TOMO, idade_0_11_1onda_cca)
idade_0_11_1onda_regiao_vent <- esimativa_rr2(idade_0_11_1onda_cca$SUPORT_VEN_TOT, idade_0_11_1onda_cca)
idade_0_11_1onda_regiao_vent_inva <- esimativa_rr2(idade_0_11_1onda_cca$SUPORT_VEN_INVA, idade_0_11_1onda_cca)
idade_0_11_1onda_regiao_vent_n_inva <- esimativa_rr2(idade_0_11_1onda_cca$SUPORT_VEN_N_INVA, idade_0_11_1onda_cca)
idade_0_11_1onda_regiao_uti <- esimativa_rr2(idade_0_11_1onda_cca$UTI, idade_0_11_1onda_cca)
idade_0_11_1onda_regiao_obito <- esimativa_rr2(idade_0_11_1onda_cca$OBITO, idade_0_11_1onda_cca)


#Calculo INCIDENCIA - PRIMEIRA ONDA
idade_12_18_1onda_regiao_caso <- idade_12_18_1onda_adolesc %>%
 group_by(REGIAO) %>%
  summarise(CASO = sum(CASO, na.rm = T),
  sum(idade_12_18_1onda_adolesc$CASO))
idade_12_18_1onda_regiao_caso$TAXA <- (idade_12_18_1onda_regiao_caso$CASO/ sum(idade_12_18_1onda_adolesc$CASO))*100



idade_12_18_1onda_regiao_amostra <- esimativa_rr2(idade_12_18_1onda_adolesc$AMOSTRA, idade_12_18_1onda_adolesc)
idade_12_18_1onda_regiao_raio_x <- esimativa_rr2(idade_12_18_1onda_adolesc$DT_RAIOX, idade_12_18_1onda_adolesc)
idade_12_18_1onda_regiao_tomo <- esimativa_rr2(idade_12_18_1onda_adolesc$DT_TOMO, idade_12_18_1onda_adolesc)
idade_12_18_1onda_regiao_vent <- esimativa_rr2(idade_12_18_1onda_adolesc$SUPORT_VEN_TOT, idade_12_18_1onda_adolesc)
idade_12_18_1onda_regiao_vent_inva <- esimativa_rr2(idade_12_18_1onda_adolesc$SUPORT_VEN_INVA, idade_12_18_1onda_adolesc)
idade_12_18_1onda_regiao_vent_n_inva <- esimativa_rr2(idade_12_18_1onda_adolesc$SUPORT_VEN_N_INVA, idade_12_18_1onda_adolesc)
idade_12_18_1onda_regiao_uti <- esimativa_rr2(idade_12_18_1onda_adolesc$UTI, idade_12_18_1onda_adolesc)
idade_12_18_1onda_regiao_obito <- esimativa_rr2(idade_12_18_1onda_adolesc$OBITO, idade_12_18_1onda_adolesc)

onda_regiao_0_11 <- data.frame(idade_0_11_1onda_regiao_amostra[[2]][4],
          idade_0_11_1onda_regiao_raio_x[[2]][4],
          idade_0_11_1onda_regiao_tomo[[2]][4],
          idade_0_11_1onda_regiao_vent[[2]][4],
          idade_0_11_1onda_regiao_vent_inva[[2]][4],
          idade_0_11_1onda_regiao_vent_n_inva[[2]][4],
          idade_0_11_1onda_regiao_uti[[2]][4],
          idade_0_11_1onda_regiao_obito[[2]][4])
names(onda_regiao_0_11) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")


onda_regiao_12_18 <- data.frame(idade_12_18_1onda_regiao_amostra[[2]][4],
          idade_12_18_1onda_regiao_raio_x[[2]][4],
          idade_12_18_1onda_regiao_tomo[[2]][4],
          idade_12_18_1onda_regiao_vent[[2]][4],
          idade_12_18_1onda_regiao_vent_inva[[2]][4],
          idade_12_18_1onda_regiao_vent_n_inva[[2]][4],
          idade_12_18_1onda_regiao_uti[[2]][4],
          idade_12_18_1onda_regiao_obito[[2]][4])

names(onda_regiao_12_18) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")


onda_regiao <- rbind(onda_regiao_0_11, onda_regiao_12_18) %>% as.data.frame()


```



```{r include=FALSE}

###########################################################################
#Internados por REGIÕES - SEGUNDA ONDA

#Calculo INCIDENCIA - SEGUNDA ONDA
idade_0_11_2onda_regiao_caso <- idade_0_11_2onda_cca %>%
 group_by(REGIAO) %>%
  summarise(CASO = sum(CASO, na.rm = T),
  sum(idade_0_11_2onda_cca$CASO))
idade_0_11_2onda_regiao_caso$TAXA <- (idade_0_11_2onda_regiao_caso$CASO/ sum(idade_0_11_2onda_cca$CASO))*100



idade_0_11_2onda_regiao_amostra <- esimativa_rr2(idade_0_11_2onda_cca$AMOSTRA, idade_0_11_2onda_cca)
idade_0_11_2onda_regiao_raio_x <- esimativa_rr2(idade_0_11_2onda_cca$DT_RAIOX, idade_0_11_2onda_cca)
idade_0_11_2onda_regiao_tomo <- esimativa_rr2(idade_0_11_2onda_cca$DT_TOMO, idade_0_11_2onda_cca)
idade_0_11_2onda_regiao_vent <- esimativa_rr2(idade_0_11_2onda_cca$SUPORT_VEN_TOT, idade_0_11_2onda_cca)
idade_0_11_2onda_regiao_vent_inva <- esimativa_rr2(idade_0_11_2onda_cca$SUPORT_VEN_INVA, idade_0_11_2onda_cca)
idade_0_11_2onda_regiao_vent_n_inva <- esimativa_rr2(idade_0_11_2onda_cca$SUPORT_VEN_N_INVA, idade_0_11_2onda_cca)
idade_0_11_2onda_regiao_uti <- esimativa_rr2(idade_0_11_2onda_cca$UTI, idade_0_11_2onda_cca)
idade_0_11_2onda_regiao_obito <- esimativa_rr2(idade_0_11_2onda_cca$OBITO, idade_0_11_2onda_cca)


#Calculo INCIDENCIA - SEGUNDA ONDA
idade_12_18_2onda_regiao_caso <- idade_12_18_2onda_adolesc %>%
 group_by(REGIAO) %>%
  summarise(CASO = sum(CASO, na.rm = T),
  sum(idade_12_18_2onda_adolesc$CASO))
idade_12_18_2onda_regiao_caso$TAXA <- (idade_12_18_2onda_regiao_caso$CASO/ sum(idade_12_18_2onda_adolesc$CASO))*100


idade_12_18_2onda_regiao_amostra <- esimativa_rr2(idade_12_18_2onda_adolesc$AMOSTRA, idade_12_18_2onda_adolesc)
idade_12_18_2onda_regiao_raio_x <- esimativa_rr2(idade_12_18_2onda_adolesc$DT_RAIOX, idade_12_18_2onda_adolesc)
idade_12_18_2onda_regiao_tomo <- esimativa_rr2(idade_12_18_2onda_adolesc$DT_TOMO, idade_12_18_2onda_adolesc)
idade_12_18_2onda_regiao_vent <- esimativa_rr2(idade_12_18_2onda_adolesc$SUPORT_VEN_TOT, idade_12_18_2onda_adolesc)
idade_12_18_2onda_regiao_vent_inva <- esimativa_rr2(idade_12_18_2onda_adolesc$SUPORT_VEN_INVA, idade_12_18_2onda_adolesc)
idade_12_18_2onda_regiao_vent_n_inva <- esimativa_rr2(idade_12_18_2onda_adolesc$SUPORT_VEN_N_INVA, idade_12_18_2onda_adolesc)
idade_12_18_2onda_regiao_uti <- esimativa_rr2(idade_12_18_2onda_adolesc$UTI, idade_12_18_2onda_adolesc)
idade_12_18_2onda_regiao_obito <- esimativa_rr2(idade_12_18_2onda_adolesc$OBITO, idade_12_18_2onda_adolesc)

seg_onda_regiao_0_11 <- data.frame(idade_0_11_2onda_regiao_amostra[[2]][4],
          idade_0_11_2onda_regiao_raio_x[[2]][4],
          idade_0_11_2onda_regiao_tomo[[2]][4],
          idade_0_11_2onda_regiao_vent[[2]][4],
          idade_0_11_2onda_regiao_vent_inva[[2]][4],
          idade_0_11_2onda_regiao_vent_n_inva[[2]][4],
          idade_0_11_2onda_regiao_uti[[2]][4],
          idade_0_11_2onda_regiao_obito[[2]][4])
names(seg_onda_regiao_0_11) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")


seg_onda_regiao_12_18 <- data.frame(idade_12_18_2onda_regiao_amostra[[2]][4],
          idade_12_18_2onda_regiao_raio_x[[2]][4],
          idade_12_18_2onda_regiao_tomo[[2]][4],
          idade_12_18_2onda_regiao_vent[[2]][4],
          idade_12_18_2onda_regiao_vent_inva[[2]][4],
          idade_12_18_2onda_regiao_vent_n_inva[[2]][4],
          idade_12_18_2onda_regiao_uti[[2]][4],
          idade_12_18_2onda_regiao_obito[[2]][4])

names(seg_onda_regiao_12_18) <- c("Amostra (IC 95%)",
                     "RX (IC 95%)",
                     "Tomo (IC 95%)",
                     "Ventilação Total (IC 95%)",
                     "Ventilação Invasiva (IC 95%)",
                     "Ventilação Não Invasiva (IC 95%)",
                     "UTI (IC 95%)",
                     "Óbito (IC 95%)")


seg_onda_regiao <- rbind(seg_onda_regiao_0_11, seg_onda_regiao_12_18) %>% as.data.frame()


```




```{r include=FALSE}

base_inter$FAIXA_ETARIA_0_11 <- ifelse(base_inter$IDADE < 12, 1, 0)
base_inter$FAIXA_ETARIA_12_18 <- ifelse(base_inter$IDADE >= 12, 1, 0)

base_fim <- base_inter %>% select(Decil,FAIXA_ETARIA_0_11,FAIXA_ETARIA_12_18, AMOSTRA, DT_RAIOX, DT_TOMO, SUPORT_VEN_TOT, SUPORT_VEN_INVA, SUPORT_VEN_N_INVA, UTI, OBITO)
base_fim$Decil <- as.factor(base_fim$Decil)
base_fim$AMOSTRA <- as.factor(base_fim$AMOSTRA)
base_fim$DT_RAIOX <- as.factor(base_fim$DT_RAIOX)
base_fim$DT_TOMO <- as.factor(base_fim$DT_TOMO)
base_fim$SUPORT_VEN_TOT <- as.factor(base_fim$SUPORT_VEN_TOT)
base_fim$SUPORT_VEN_INVA <- as.factor(base_fim$SUPORT_VEN_INVA)
base_fim$SUPORT_VEN_N_INVA <- as.factor(base_fim$SUPORT_VEN_N_INVA)
base_fim$UTI <- as.factor(base_fim$UTI)
base_fim$OBITO <- as.factor(base_fim$OBITO)

```

Tabela 1: Distribuição dos óbitos, internações em UTI, suporte ventilatório e intervenções diagnósticas em crianças e adolescentes internadas por COVID-19, segundo o PIB. Brasil, 2020- maio 2021.
```{r echo=FALSE}

base_fim1 <- subset(base_fim, FAIXA_ETARIA_0_11 == 1)
base_fim1$FAIXA_ETARIA_12_18 <- NULL
base_fim1$FAIXA_ETARIA_0_11 <- NULL

sumario1 <- finalfit::summary_factorlist(
    base_fim1,
    dependent = "Decil",
    explanatory = c("AMOSTRA", "DT_RAIOX", "DT_TOMO", "SUPORT_VEN_TOT", "SUPORT_VEN_INVA", "SUPORT_VEN_N_INVA","UTI","OBITO") ,
    total_col = TRUE
)

sumario1 <- t(sumario1)

base_fim2 <- subset(base_fim, FAIXA_ETARIA_12_18 == 1)
base_fim2$FAIXA_ETARIA_12_18 <- NULL
base_fim2$FAIXA_ETARIA_0_11 <- NULL

sumario2 <- finalfit::summary_factorlist(
    base_fim2,
    dependent = "Decil",
    explanatory = c("AMOSTRA", "DT_RAIOX", "DT_TOMO", "SUPORT_VEN_TOT", "SUPORT_VEN_INVA", "SUPORT_VEN_N_INVA","UTI","OBITO") ,
    total_col = TRUE
)

sumario2 <- t(sumario2)

sumario <- rbind(sumario1, sumario2) %>% as.data.frame()

knitr::kable(sumario)


write.csv(sumario, "bases/sumario.csv", row.names = T)
```


Tabela 2: Risco de óbito, internação em UTI, suporte ventilatório e intervenções diagnósticas em crianças e adolescentes internadas por COVID-19, segundo decil do PIB. Brasil, 2020- maio 2021.
```{r echo=FALSE}
knitr::kable(inter)
write.csv(inter, "bases/inter.csv", row.names = T)
```

Tabela 3: Risco de óbito, internação em UTI, suporte ventilatório e intervenções diagnósticas em crianças e adolescentes internadas por COVID-19, segundo decil do PIB. PRIMEIRA ONDA. Brasil, 2020- maio 2021.

```{r echo=FALSE}
knitr::kable(onda)
write.csv(onda, "bases/onda.csv", row.names = T)
```


Tabela 4: Risco de óbito, internação em UTI, suporte ventilatório e intervenções diagnósticas em crianças e adolescentes internadas por COVID-19, segundo decil do PIB. SEGUNDA ONDA. Brasil, 2020- maio 2021.

```{r echo=FALSE}
knitr::kable(seg_onda)
write.csv(seg_onda, "bases/seg_onda.csv", row.names = T)
```


Tabela 5: Risco de óbito, internação em UTI, suporte ventilatório e intervenções diagnósticas em crianças e adolescentes internadas por COVID-19, segundo REGIAO. PRIMEIRA ONDA. Brasil, 2020- maio 2021.

```{r echo=FALSE}
knitr::kable(onda_regiao)
write.csv(onda_regiao, "bases/onda_regiao.csv", row.names = T)
```

Tabela 6: Risco de óbito, internação em UTI, suporte ventilatório e intervenções diagnósticas em crianças e adolescentes internadas por COVID-19, segundo REGIAO. SEGUNDA ONDA. Brasil, 2020- maio 2021.

```{r echo=FALSE}
knitr::kable(seg_onda_regiao)
write.csv(seg_onda_regiao, "bases/seg_onda_regiao.csv", row.names = T)
```



```{r echo=FALSE, fig.height= 13, fig.width= 10}
# ######## Grafico #######
# inter_0_11_plot <- data.frame(idade_0_11_inter_amostra[[2]][c(1,2,3)],
#           idade_0_11_inter_raio_x[[2]][c(1,2,3)],
#           idade_0_11_inter_tomo[[2]][c(1,2,3)],
#           idade_0_11_inter_vent[[2]][c(1,2,3)],
#           idade_0_11_inter_vent_inva[[2]][c(1,2,3)],
#           idade_0_11_inter_vent_n_inva[[2]][c(1,2,3)],
#           idade_0_11_inter_uti[[2]][c(1,2,3)],
#           idade_0_11_inter_obito[[2]][c(1,2,3)])
# names(inter_0_11_plot) <- c("Amostra",
#                             "Amostra 2,5%",
#                             "Amostra 97,5",
#                             "Raio X",
#                             "Raio X 2,5%",
#                             "Raio X 97,5%",
#                             "Tomografia",
#                             "Tomografia 2,5%",
#                             "Tomografia 97,5",
#                             "Suporte Ventilatório",
#                             "Suporte Ventilatório 2,5%",
#                             "Suporte Ventilatório 97,5",
#                             "Ventilação Invasiva",
#                             "Ventilação Invasiva 2,5%",
#                             "Ventilação Invasiva 97,5",
#                             "Ventilação Não Invasiva",
#                             "Ventilação Não Invasiva 2,5%",
#                             "Ventilação Não Invasiva 97,5",
#                             "UTI",
#                             "UTI 2,5%",
#                             "UTI 97,5",
#                             "Óbito",
#                             "Óbito 2,5%",
#                             "Óbito 97,5")
# 
# inter_0_11_plot$Decil <- row.names(inter_0_11_plot)
# inter_0_11_plot <- subset(inter_0_11_plot, inter_0_11_plot$Decil != "(Intercept)")
# inter_0_11_plot[10,] <- 1
# inter_0_11_plot$Decil <- ifelse(inter_0_11_plot$Decil == 1, "Decil1", inter_0_11_plot$Decil)
# 
# inter_0_11_plot$Decil <- factor(inter_0_11_plot$Decil, levels = c("Decil1",
#                                                                  "Decil2",
#                                                                  "Decil3",
#                                                                  "Decil4",
#                                                                  "Decil5",
#                                                                  "Decil6",
#                                                                  "Decil7",
#                                                                  "Decil8",
#                                                                  "Decil9",
#                                                                  "Decil10"))
# inter_0_11_plot <- melt(inter_0_11_plot, id.var = "Decil")
# 
# inter_0_11_medias <- c("Amostra",
#                         "Raio X",
#                         "Tomografia",
#                         "Suporte Ventilatório",
#                         "Ventilação Invasiva",
#                         "Ventilação Não Invasiva",
#                         "UTI",
#                         "Óbito")
# 
# inter_0_11_plot_medias <- subset(inter_0_11_plot, inter_0_11_plot$variable %in% inter_0_11_medias)
# 
# cc <- scales::seq_gradient_pal("black", "gray", "Lab")(seq(0,1,length.out=10))
# ggplot (onda_0_11_plot_medias, aes(x=value, y=1, color=Decil)) +
#   geom_point(size = 10, alpha = 0.5)+
#   facet_grid(variable ~.)+
#   scale_colour_manual(values=cc)+
#   theme_bw()+
#   theme(axis.title.y=element_blank(),
#         axis.text.y=element_blank(),
#         axis.ticks.y=element_blank())+
#   xlab("Risco Relativo")+
#   geom_vline(xintercept = 1)


```

Figura 2: Risco de óbito, internação em UTI, suporte ventilatório e intervenções diagnósticas em adolescentes (12-18 anos) internadas por COVID-19, segundo decil do PIB. Brasil, 2020- maio 2021.


```{r echo=FALSE, fig.height= 13, fig.width= 10}
######## Grafico INTERNADOS ####### 
# inter_12_18_plot <- data.frame(idade_12_18_inter_amostra[[2]][c(1,2,3)],
#           idade_12_18_inter_raio_x[[2]][c(1,2,3)],
#           idade_12_18_inter_tomo[[2]][c(1,2,3)],
#           idade_12_18_inter_vent[[2]][c(1,2,3)],
#           idade_12_18_inter_vent_inva[[2]][c(1,2,3)],
#           idade_12_18_inter_vent_n_inva[[2]][c(1,2,3)],
#           idade_12_18_inter_uti[[2]][c(1,2,3)],
#           idade_12_18_inter_obito[[2]][c(1,2,3)])
# names(inter_12_18_plot) <- c("Amostra", 
#                             "Amostra 2,5%", 
#                             "Amostra 97,5", 
#                             "Raio X", 
#                             "Raio X 2,5%", 
#                             "Raio X 97,5%", 
#                             "Tomografia",
#                             "Tomografia 2,5%",
#                             "Tomografia 97,5",
#                             "Suporte Ventilatório",
#                             "Suporte Ventilatório 2,5%",
#                             "Suporte Ventilatório 97,5",
#                             "Ventilação Invasiva",
#                             "Ventilação Invasiva 2,5%",
#                             "Ventilação Invasiva 97,5",
#                             "Ventilação Não Invasiva",
#                             "Ventilação Não Invasiva 2,5%",
#                             "Ventilação Não Invasiva 97,5",
#                             "UTI",
#                             "UTI 2,5%",
#                             "UTI 97,5",
#                             "Óbito",
#                             "Óbito 2,5%",
#                             "Óbito 97,5")
# 
# inter_12_18_plot$Decil <- row.names(inter_12_18_plot)
# inter_12_18_plot <- subset(inter_12_18_plot, inter_12_18_plot$Decil != "(Intercept)")
# inter_12_18_plot[10,] <- 1
# inter_12_18_plot$Decil <- ifelse(inter_12_18_plot$Decil == 1, "Decil1", inter_12_18_plot$Decil)
# 
# inter_12_18_plot$Decil <- factor(inter_12_18_plot$Decil, levels = c("Decil1",
#                                                                  "Decil2",
#                                                                  "Decil3",
#                                                                  "Decil4",
#                                                                  "Decil5",
#                                                                  "Decil6",
#                                                                  "Decil7",
#                                                                  "Decil8",
#                                                                  "Decil9",
#                                                                  "Decil10"))
# inter_12_18_plot <- melt(inter_12_18_plot, id.var = "Decil")
# 
# inter_12_18_medias <- c("Amostra",
#                         "Raio X", 
#                         "Tomografia",
#                         "Suporte Ventilatório",
#                         "Ventilação Invasiva",
#                         "Ventilação Não Invasiva",
#                         "UTI",
#                         "Óbito")
# 
# inter_12_18_plot_medias <- subset(inter_12_18_plot, inter_12_18_plot$variable %in% inter_12_18_medias)
# 
# cc <- scales::seq_gradient_pal("blue", "red", "Lab")(seq(0,1,length.out=10))
# ggplot (inter_12_18_plot_medias, aes(x=value, y=1, color=Decil)) + 
#   geom_point(size = 10, alpha = 0.5)+
#   facet_grid(variable ~.)+
#   scale_colour_manual(values=cc)+
#   theme_bw()+
#   theme(axis.title.y=element_blank(),
#         axis.text.y=element_blank(),
#         axis.ticks.y=element_blank())+
#   xlab("Risco Relativo")+
#   geom_vline(xintercept = 1)


```



```{r echo=FALSE, fig.height= 12, fig.width= 09}
######## Grafico OBITO Artigo ####### 

# cc <- scales::seq_gradient_pal("black", "gray", "Lab")(seq(0,1,length.out=10))
# g1 <- ggplot (obito_0_11_plot_medias, aes(x=value, y=1, color=Decil)) + 
#     geom_point(size = 10, alpha = 0.5)+
#     facet_grid(variable ~.)+
#     scale_colour_manual(values=cc)+
#     theme_bw()+
#     theme(axis.title.y=element_blank(),
#           axis.text.y=element_blank(),
#           axis.ticks.y=element_blank())+
#     xlab("Risco Relativo")+
#     geom_vline(xintercept = 1)
#  
#  
#  
# cc <- scales::seq_gradient_pal("black", "gray", "Lab")(seq(0,1,length.out=10))
# g2 <- ggplot (obito_12_18_plot_medias, aes(x=value, y=1, color=Decil)) + 
#     geom_point(size = 10, alpha = 0.5)+
#     facet_grid(variable ~.)+
#     scale_colour_manual(values=cc)+
#     theme_bw()+
#     theme(axis.title.y=element_blank(),
#           axis.text.y=element_blank(),
#           axis.ticks.y=element_blank())+
#     xlab("Risco Relativo")+
#     geom_vline(xintercept = 1)
# 
# 
# 
# library(ggpubr)
# ggpubr::ggarrange(g1,g2,labels = c("A", "B"), ncol = 2, legend = "right",common.legend = T)


```

```{r echo=FALSE, fig.height= 12, fig.width= 09}
######## Grafico internações Artigo ####### 

# cc <- scales::seq_gradient_pal("black", "gray", "Lab")(seq(0,1,length.out=10))
# g3 <- ggplot (inter_0_11_plot_medias, aes(x=value, y=1, color=Decil)) + 
#   geom_point(size = 10, alpha = 0.5)+
#   facet_grid(variable ~.)+
#   scale_colour_manual(values=cc)+
#   theme_bw()+
#   theme(axis.title.y=element_blank(),
#         axis.text.y=element_blank(),
#         axis.ticks.y=element_blank())+
#   xlab("Risco Relativo")+
#   geom_vline(xintercept = 1)
# 
# 
# 
# cc <- scales::seq_gradient_pal("black", "gray", "Lab")(seq(0,1,length.out=10))
# g4 <- ggplot (inter_12_18_plot_medias, aes(x=value, y=1, color=Decil)) + 
#   geom_point(size = 10, alpha = 0.5)+
#   facet_grid(variable ~.)+
#   scale_colour_manual(values=cc)+
#   theme_bw()+
#   theme(axis.title.y=element_blank(),
#         axis.text.y=element_blank(),
#         axis.ticks.y=element_blank())+
#   xlab("Risco Relativo")+
#   geom_vline(xintercept = 1)
# 
# 
# library(ggpubr)
# ggpubr::ggarrange(g3,g4,labels = c("A", "B"), ncol = 2, legend = "right",common.legend = T)
# 
# 
# 

```






```{r echo=FALSE, fig.height= 12, fig.width= 12}

## Criacao plot primeira onda em crianças
onda1_0_11_plot <- data.frame(idade_0_11_1onda_amostra[[2]][c(1,2,3)],
                              idade_0_11_1onda_raio_x[[2]][c(1,2,3)],
                              idade_0_11_1onda_tomo[[2]][c(1,2,3)],
                              idade_0_11_1onda_vent[[2]][c(1,2,3)],
                              idade_0_11_1onda_vent_inva[[2]][c(1,2,3)],
                              idade_0_11_1onda_vent_n_inva[[2]][c(1,2,3)],
                              idade_0_11_1onda_uti[[2]][c(1,2,3)],
                              idade_0_11_1onda_obito[[2]][c(1,2,3)])
names(onda1_0_11_plot) <- c("Amostra",
                            "Amostra 2,5%",
                            "Amostra 97,5",
                            "Raio X",
                            "Raio X 2,5%",
                            "Raio X 97,5%",
                            "Tomografia",
                            "Tomografia 2,5%",
                            "Tomografia 97,5",
                            "Ventilatório",
                            "Ventilatório 2,5%",
                            "Ventilatório 97,5",
                            "Invasivo",
                            "Invasivo 2,5%",
                            "Invasivo 97,5",
                            "Não Invasivo",
                            "Não Invasivo 2,5%",
                            "Não Invasivo 97,5",
                            "UTI",
                            "UTI 2,5%",
                            "UTI 97,5",
                            "Letalidade",
                            "Letalidade 2,5%",
                            "Letalidade 97,5")

onda1_0_11_plot$Decil <- row.names(onda1_0_11_plot)
onda1_0_11_plot <- subset(onda1_0_11_plot, onda1_0_11_plot$Decil != "(Intercept)")
onda1_0_11_plot[10,] <- 1
onda1_0_11_plot$Decil <- ifelse(onda1_0_11_plot$Decil == 1, "Decil1", onda1_0_11_plot$Decil)

onda1_0_11_plot$Decil <- factor(onda1_0_11_plot$Decil, levels = c("Decil1",
                                                                  "Decil2",
                                                                  "Decil3",
                                                                  "Decil4",
                                                                  "Decil5",
                                                                  "Decil6",
                                                                  "Decil7",
                                                                  "Decil8",
                                                                  "Decil9",
                                                                  "Decil10"))
onda1_0_11_plot <- melt(onda1_0_11_plot, id.var = "Decil")

onda1_0_11_medias <- c("Amostra",
                       "Raio X",
                       "Tomografia",
                       "Ventilatório",
                       "Invasivo",
                       "Não Invasivo",
                       "UTI",
                       "Letalidade")

onda1_0_11_plot_medias <- subset(onda1_0_11_plot, onda1_0_11_plot$variable %in% onda1_0_11_medias)

cc1 <- scales::seq_gradient_pal("black", "gray", "Lab")(seq(0,1,length.out=10))
g1 <- ggplot (onda1_0_11_plot_medias, aes(x=value, y=1, color=Decil)) +
  geom_point(size = 6, alpha = 0.8)+
  facet_grid(variable ~.)+
  scale_colour_manual(values=cc1)+
  theme_bw()+
  theme(axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())+
  xlab("Risco Relativo")+
  geom_vline(xintercept = 1)




## Criacao plot segunda onda em crianças
onda2_0_11_plot <- data.frame(idade_0_11_2onda_amostra[[2]][c(1,2,3)],
                              idade_0_11_2onda_raio_x[[2]][c(1,2,3)],
                              idade_0_11_2onda_tomo[[2]][c(1,2,3)],
                              idade_0_11_2onda_vent[[2]][c(1,2,3)],
                              idade_0_11_2onda_vent_inva[[2]][c(1,2,3)],
                              idade_0_11_2onda_vent_n_inva[[2]][c(1,2,3)],
                              idade_0_11_2onda_uti[[2]][c(1,2,3)],
                              idade_0_11_2onda_obito[[2]][c(1,2,3)])
names(onda2_0_11_plot) <- c("Amostra",
                            "Amostra 2,5%",
                            "Amostra 97,5",
                            "Raio X",
                            "Raio X 2,5%",
                            "Raio X 97,5%",
                            "Tomografia",
                            "Tomografia 2,5%",
                            "Tomografia 97,5",
                            "Ventilatório",
                            "Ventilatório 2,5%",
                            "Ventilatório 97,5",
                            "Invasivo",
                            "Invasivo 2,5%",
                            "Invasivo 97,5",
                            "Não Invasivo",
                            "Não Invasivo 2,5%",
                            "Não Invasivo 97,5",
                            "UTI",
                            "UTI 2,5%",
                            "UTI 97,5",
                            "Letalidade",
                            "Letalidade 2,5%",
                            "Letalidade 97,5")

onda2_0_11_plot$Decil <- row.names(onda2_0_11_plot)
onda2_0_11_plot <- subset(onda2_0_11_plot, onda2_0_11_plot$Decil != "(Intercept)")
onda2_0_11_plot[10,] <- 1
onda2_0_11_plot$Decil <- ifelse(onda2_0_11_plot$Decil == 1, "Decil1", onda2_0_11_plot$Decil)

onda2_0_11_plot$Decil <- factor(onda2_0_11_plot$Decil, levels = c("Decil1",
                                                                  "Decil2",
                                                                  "Decil3",
                                                                  "Decil4",
                                                                  "Decil5",
                                                                  "Decil6",
                                                                  "Decil7",
                                                                  "Decil8",
                                                                  "Decil9",
                                                                  "Decil10"))
onda2_0_11_plot <- melt(onda2_0_11_plot, id.var = "Decil")

onda2_0_11_medias <- c("Amostra",
                       "Raio X",
                       "Tomografia",
                       "Ventilatório",
                       "Invasivo",
                       "Não Invasivo",
                       "UTI",
                       "Letalidade")

onda2_0_11_plot_medias <- subset(onda2_0_11_plot, onda2_0_11_plot$variable %in% onda2_0_11_medias)

cc2 <- scales::seq_gradient_pal("black", "gray", "Lab")(seq(0,1,length.out=10))
g2 <- ggplot (onda2_0_11_plot_medias, aes(x=value, y=1, color=Decil)) +
  geom_point(size = 6, alpha = 0.8)+
  facet_grid(variable ~.)+
  scale_colour_manual(values=cc2)+
  theme_bw()+
  theme(axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())+
  xlab("Risco Relativo")+
  geom_vline(xintercept = 1)



## Criacao plot primeira onda em adolescente
onda1_12_18_plot <- data.frame(idade_12_18_1onda_amostra[[2]][c(1,2,3)],
                              idade_12_18_1onda_raio_x[[2]][c(1,2,3)],
                              idade_12_18_1onda_tomo[[2]][c(1,2,3)],
                              idade_12_18_1onda_vent[[2]][c(1,2,3)],
                              idade_12_18_1onda_vent_inva[[2]][c(1,2,3)],
                              idade_12_18_1onda_vent_n_inva[[2]][c(1,2,3)],
                              idade_12_18_1onda_uti[[2]][c(1,2,3)],
                              idade_12_18_1onda_obito[[2]][c(1,2,3)])
names(onda1_12_18_plot) <- c("Amostra",
                            "Amostra 2,5%",
                            "Amostra 97,5",
                            "Raio X",
                            "Raio X 2,5%",
                            "Raio X 97,5%",
                            "Tomografia",
                            "Tomografia 2,5%",
                            "Tomografia 97,5",
                            "Ventilatório",
                            "Ventilatório 2,5%",
                            "Ventilatório 97,5",
                            "Invasivo",
                            "Invasivo 2,5%",
                            "Invasivo 97,5",
                            "Não Invasivo",
                            "Não Invasivo 2,5%",
                            "Não Invasivo 97,5",
                            "UTI",
                            "UTI 2,5%",
                            "UTI 97,5",
                            "Letalidade",
                            "Letalidade 2,5%",
                            "Letalidade 97,5")

onda1_12_18_plot$Decil <- row.names(onda1_12_18_plot)
onda1_12_18_plot <- subset(onda1_12_18_plot, onda1_12_18_plot$Decil != "(Intercept)")
onda1_12_18_plot[10,] <- 1
onda1_12_18_plot$Decil <- ifelse(onda1_12_18_plot$Decil == 1, "Decil1", onda1_12_18_plot$Decil)

onda1_12_18_plot$Decil <- factor(onda1_12_18_plot$Decil, levels = c("Decil1",
                                                                  "Decil2",
                                                                  "Decil3",
                                                                  "Decil4",
                                                                  "Decil5",
                                                                  "Decil6",
                                                                  "Decil7",
                                                                  "Decil8",
                                                                  "Decil9",
                                                                  "Decil10"))
onda1_12_18_plot <- melt(onda1_12_18_plot, id.var = "Decil")

onda1_12_18_medias <- c("Amostra",
                       "Raio X",
                       "Tomografia",
                       "Ventilatório",
                       "Invasivo",
                       "Não Invasivo",
                       "UTI",
                       "Letalidade")

onda1_12_18_plot_medias <- subset(onda1_12_18_plot, onda1_12_18_plot$variable %in% onda1_12_18_medias)

cc3 <- scales::seq_gradient_pal("black", "gray", "Lab")(seq(0,1,length.out=10))
g3 <- ggplot (onda1_12_18_plot_medias, aes(x=value, y=1, color=Decil)) +
  geom_point(size = 6, alpha = 0.8)+
  facet_grid(variable ~.)+
  scale_colour_manual(values=cc3)+
  theme_bw()+
  theme(axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())+
  xlab("Risco Relativo")+
  geom_vline(xintercept = 1)





## Criacao plot segunda onda onda em adolescente
onda2_12_18_plot <- data.frame(idade_12_18_2onda_amostra[[2]][c(1,2,3)],
                               idade_12_18_2onda_raio_x[[2]][c(1,2,3)],
                               idade_12_18_2onda_tomo[[2]][c(1,2,3)],
                               idade_12_18_2onda_vent[[2]][c(1,2,3)],
                               idade_12_18_2onda_vent_inva[[2]][c(1,2,3)],
                               idade_12_18_2onda_vent_n_inva[[2]][c(1,2,3)],
                               idade_12_18_2onda_uti[[2]][c(1,2,3)],
                               idade_12_18_2onda_obito[[2]][c(1,2,3)])
names(onda2_12_18_plot) <- c("Amostra",
                             "Amostra 2,5%",
                             "Amostra 97,5",
                             "Raio X",
                             "Raio X 2,5%",
                             "Raio X 97,5%",
                             "Tomografia",
                             "Tomografia 2,5%",
                             "Tomografia 97,5",
                             "Ventilatório",
                             "Ventilatório 2,5%",
                             "Ventilatório 97,5",
                             "Invasivo",
                             "Invasivo 2,5%",
                             "Invasivo 97,5",
                             "Não Invasivo",
                             "Não Invasivo 2,5%",
                             "Não Invasivo 97,5",
                             "UTI",
                             "UTI 2,5%",
                             "UTI 97,5",
                             "Letalidade",
                             "Letalidade 2,5%",
                             "Letalidade 97,5")

onda2_12_18_plot$Decil <- row.names(onda2_12_18_plot)
onda2_12_18_plot <- subset(onda2_12_18_plot, onda2_12_18_plot$Decil != "(Intercept)")
onda2_12_18_plot[10,] <- 1
onda2_12_18_plot$Decil <- ifelse(onda2_12_18_plot$Decil == 1, "Decil1", onda2_12_18_plot$Decil)

onda2_12_18_plot$Decil <- factor(onda2_12_18_plot$Decil, levels = c("Decil1",
                                                                    "Decil2",
                                                                    "Decil3",
                                                                    "Decil4",
                                                                    "Decil5",
                                                                    "Decil6",
                                                                    "Decil7",
                                                                    "Decil8",
                                                                    "Decil9",
                                                                    "Decil10"))
onda2_12_18_plot <- melt(onda2_12_18_plot, id.var = "Decil")

onda2_12_18_medias <- c("Amostra",
                        "Raio X",
                        "Tomografia",
                        "Ventilatório",
                        "Invasivo",
                        "Não Invasivo",
                        "UTI",
                        "Letalidade")

onda2_12_18_plot_medias <- subset(onda2_12_18_plot, onda2_12_18_plot$variable %in% onda2_12_18_medias)

cc4 <- scales::seq_gradient_pal("black", "gray", "Lab")(seq(0,1,length.out=10))
g4 <- ggplot (onda2_12_18_plot_medias, aes(x=value, y=1, color=Decil)) +
  geom_point(size = 6, alpha = 0.8)+
  facet_grid(variable ~.)+
  scale_colour_manual(values=cc4)+
  theme_bw()+
  theme(axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())+
  xlab("Risco Relativo")+
  geom_vline(xintercept = 1)

```

```{r echo=FALSE, fig.height= 10, fig.width= 18}


#Juntando os graficos
ggpubr::ggarrange(g1,g2,g3,g4,
                  labels = c("A", "B", "C", "D"), ncol = 4, 
                  legend = "bottom",common.legend = T)


```
```{r echo=FALSE, fig.height= 12, fig.width= 12}

######## ANALISE REGIONAL ############
## Criacao plot primeira onda em crianças
onda1_regiao_0_11_plot <- data.frame(idade_0_11_1onda_regiao_amostra[[2]][c(1,2,3)],
                              idade_0_11_1onda_regiao_raio_x[[2]][c(1,2,3)],
                              idade_0_11_1onda_regiao_tomo[[2]][c(1,2,3)],
                              idade_0_11_1onda_regiao_vent[[2]][c(1,2,3)],
                              idade_0_11_1onda_regiao_vent_inva[[2]][c(1,2,3)],
                              idade_0_11_1onda_regiao_vent_n_inva[[2]][c(1,2,3)],
                              idade_0_11_1onda_regiao_uti[[2]][c(1,2,3)],
                              idade_0_11_1onda_regiao_obito[[2]][c(1,2,3)])
names(onda1_regiao_0_11_plot) <- c("Amostra",
                            "Amostra 2,5%",
                            "Amostra 97,5",
                            "Raio X",
                            "Raio X 2,5%",
                            "Raio X 97,5%",
                            "Tomografia",
                            "Tomografia 2,5%",
                            "Tomografia 97,5",
                            "Ventilatório",
                            "Ventilatório 2,5%",
                            "Ventilatório 97,5",
                            "Invasivo",
                            "Invasivo 2,5%",
                            "Invasivo 97,5",
                            "Não Invasivo",
                            "Não Invasivo 2,5%",
                            "Não Invasivo 97,5",
                            "UTI",
                            "UTI 2,5%",
                            "UTI 97,5",
                            "Letalidade",
                            "Letalidade 2,5%",
                            "Letalidade 97,5")

onda1_regiao_0_11_plot$Regiao <- row.names(onda1_regiao_0_11_plot)
onda1_regiao_0_11_plot <- subset(onda1_regiao_0_11_plot, onda1_regiao_0_11_plot$Regiao != "(Intercept)")
onda1_regiao_0_11_plot[5,] <- 1
onda1_regiao_0_11_plot$Regiao <- ifelse(onda1_regiao_0_11_plot$Regiao == 1, "REGIAONORDESTE", onda1_regiao_0_11_plot$Regiao)

onda1_regiao_0_11_plot$Regiao <- factor(onda1_regiao_0_11_plot$Regiao, levels = c("REGIAONORDESTE",
                                                                                 "REGIAONORTE",
                                                                                 "REGIAOCENTRO-OESTE",
                                                                                 "REGIAOSUL",
                                                                                 "REGIAOSUDESTE"))	
                                                                      

onda1_regiao_0_11_plot <- melt(onda1_regiao_0_11_plot, id.var = "Regiao")

onda1_regiao_0_11_medias <- c("Amostra",
                       "Raio X",
                       "Tomografia",
                       "Ventilatório",
                       "Invasivo",
                       "Não Invasivo",
                       "UTI",
                       "Letalidade")

onda1_regiao_0_11_plot_medias <- subset(onda1_regiao_0_11_plot, onda1_regiao_0_11_plot$variable %in% onda1_regiao_0_11_medias)

cc5 <- scales::seq_gradient_pal("black", "grey100", "Lab")(seq(0,1,length.out=6))
g5 <- ggplot (onda1_regiao_0_11_plot_medias, aes(x=value, y=1, color=Regiao)) +
  geom_point(size = 6, alpha = 0.8)+
  facet_grid(variable ~.)+
  scale_colour_manual(values=cc5,
                      name = " ",
                      labels = c("Nordeste", "Norte", "Centro-Oeste", "Sul", "Sudeste"),
                      guide = "legend")+
  theme_bw()+
  theme(axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())+
  xlab("Risco Relativo")+
  geom_vline(xintercept = 1)



  ## Criacao plot SEGUNDA onda em crianças
  onda2_regiao_0_11_plot <- data.frame(idade_0_11_2onda_regiao_amostra[[2]][c(1,2,3)],
                                       idade_0_11_2onda_regiao_raio_x[[2]][c(1,2,3)],
                                       idade_0_11_2onda_regiao_tomo[[2]][c(1,2,3)],
                                       idade_0_11_2onda_regiao_vent[[2]][c(1,2,3)],
                                       idade_0_11_2onda_regiao_vent_inva[[2]][c(1,2,3)],
                                       idade_0_11_2onda_regiao_vent_n_inva[[2]][c(1,2,3)],
                                       idade_0_11_2onda_regiao_uti[[2]][c(1,2,3)],
                                       idade_0_11_2onda_regiao_obito[[2]][c(1,2,3)])
  names(onda2_regiao_0_11_plot) <- c("Amostra",
                                     "Amostra 2,5%",
                                     "Amostra 97,5",
                                     "Raio X",
                                     "Raio X 2,5%",
                                     "Raio X 97,5%",
                                     "Tomografia",
                                     "Tomografia 2,5%",
                                     "Tomografia 97,5",
                                     "Ventilatório",
                                     "Ventilatório 2,5%",
                                     "Ventilatório 97,5",
                                     "Invasivo",
                                     "Invasivo 2,5%",
                                     "Invasivo 97,5",
                                     "Não Invasivo",
                                     "Não Invasivo 2,5%",
                                     "Não Invasivo 97,5",
                                     "UTI",
                                     "UTI 2,5%",
                                     "UTI 97,5",
                                     "Letalidade",
                                     "Letalidade 2,5%",
                                     "Letalidade 97,5")
  
  onda2_regiao_0_11_plot$Regiao <- row.names(onda2_regiao_0_11_plot)
  onda2_regiao_0_11_plot <- subset(onda2_regiao_0_11_plot, onda2_regiao_0_11_plot$Regiao != "(Intercept)")
  onda2_regiao_0_11_plot[5,] <- 1
  onda2_regiao_0_11_plot$Regiao <- ifelse(onda2_regiao_0_11_plot$Regiao == 1, "REGIAONORDESTE", onda2_regiao_0_11_plot$Regiao)
  
  onda2_regiao_0_11_plot$Regiao <- factor(onda2_regiao_0_11_plot$Regiao, levels = c("REGIAONORDESTE",
                                                                                    "REGIAONORTE",
                                                                                    "REGIAOCENTRO-OESTE",
                                                                                    "REGIAOSUL",
                                                                                    "REGIAOSUDESTE"))	
  
  
  onda2_regiao_0_11_plot <- melt(onda2_regiao_0_11_plot, id.var = "Regiao")
  
  onda2_regiao_0_11_medias <- c("Amostra",
                                "Raio X",
                                "Tomografia",
                                "Ventilatório",
                                "Invasivo",
                                "Não Invasivo",
                                "UTI",
                                "Letalidade")
  
  onda2_regiao_0_11_plot_medias <- subset(onda2_regiao_0_11_plot, onda2_regiao_0_11_plot$variable %in% onda2_regiao_0_11_medias)
  
  cc6 <- scales::seq_gradient_pal("black", "grey100", "Lab")(seq(0,1,length.out=6))
  g6 <- ggplot (onda2_regiao_0_11_plot_medias, aes(x=value, y=1, color=Regiao)) +
    geom_point(size = 6, alpha = 0.8)+
    facet_grid(variable ~.)+
    scale_colour_manual(values=cc6,
                        name = " ",
                        labels = c("Nordeste", "Norte", "Centro-Oeste", "Sul", "Sudeste"),
                        guide = "legend")+
    theme_bw()+
    theme(axis.title.y=element_blank(),
          axis.text.y=element_blank(),
          axis.ticks.y=element_blank())+
    xlab("Risco Relativo")+
    geom_vline(xintercept = 1)
  
  

  ## Criacao plot primeira onda em adolescente
  onda1_regiao_12_18_plot <- data.frame(idade_12_18_1onda_regiao_amostra[[2]][c(1,2,3)],
                                       idade_12_18_1onda_regiao_raio_x[[2]][c(1,2,3)],
                                       idade_12_18_1onda_regiao_tomo[[2]][c(1,2,3)],
                                       idade_12_18_1onda_regiao_vent[[2]][c(1,2,3)],
                                       idade_12_18_1onda_regiao_vent_inva[[2]][c(1,2,3)],
                                       idade_12_18_1onda_regiao_vent_n_inva[[2]][c(1,2,3)],
                                       idade_12_18_1onda_regiao_uti[[2]][c(1,2,3)],
                                       idade_12_18_1onda_regiao_obito[[2]][c(1,2,3)])
  names(onda1_regiao_12_18_plot) <- c("Amostra",
                                     "Amostra 2,5%",
                                     "Amostra 97,5",
                                     "Raio X",
                                     "Raio X 2,5%",
                                     "Raio X 97,5%",
                                     "Tomografia",
                                     "Tomografia 2,5%",
                                     "Tomografia 97,5",
                                     "Ventilatório",
                                     "Ventilatório 2,5%",
                                     "Ventilatório 97,5",
                                     "Invasivo",
                                     "Invasivo 2,5%",
                                     "Invasivo 97,5",
                                     "Não Invasivo",
                                     "Não Invasivo 2,5%",
                                     "Não Invasivo 97,5",
                                     "UTI",
                                     "UTI 2,5%",
                                     "UTI 97,5",
                                     "Letalidade",
                                     "Letalidade 2,5%",
                                     "Letalidade 97,5")
  
  onda1_regiao_12_18_plot$Regiao <- row.names(onda1_regiao_12_18_plot)
  onda1_regiao_12_18_plot <- subset(onda1_regiao_12_18_plot, onda1_regiao_12_18_plot$Regiao != "(Intercept)")
  onda1_regiao_12_18_plot[5,] <- 1
  onda1_regiao_12_18_plot$Regiao <- ifelse(onda1_regiao_12_18_plot$Regiao == 1, "REGIAONORDESTE", onda1_regiao_12_18_plot$Regiao)
  
  onda1_regiao_12_18_plot$Regiao <- factor(onda1_regiao_12_18_plot$Regiao, levels = c("REGIAONORDESTE",
                                                                                    "REGIAONORTE",
                                                                                    "REGIAOCENTRO-OESTE",
                                                                                    "REGIAOSUL",
                                                                                    "REGIAOSUDESTE"))	
  
  
  onda1_regiao_12_18_plot <- melt(onda1_regiao_12_18_plot, id.var = "Regiao")
  
  onda1_regiao_12_18_medias <- c("Amostra",
                                "Raio X",
                                "Tomografia",
                                "Ventilatório",
                                "Invasivo",
                                "Não Invasivo",
                                "UTI",
                                "Letalidade")
  
  onda1_regiao_12_18_plot_medias <- subset(onda1_regiao_12_18_plot, onda1_regiao_12_18_plot$variable %in% onda1_regiao_12_18_medias)
  
  cc7 <- scales::seq_gradient_pal("black", "grey100", "Lab")(seq(0,1,length.out=6))
  g7 <- ggplot (onda1_regiao_12_18_plot_medias, aes(x=value, y=1, color=Regiao)) +
    geom_point(size = 6, alpha = 0.8)+
    facet_grid(variable ~.)+
    scale_colour_manual(values=cc7,
                        name = " ",
                        labels = c("Nordeste", "Norte", "Centro-Oeste", "Sul", "Sudeste"),
                        guide = "legend")+
    theme_bw()+
    theme(axis.title.y=element_blank(),
          axis.text.y=element_blank(),
          axis.ticks.y=element_blank())+
    xlab("Risco Relativo")+
    geom_vline(xintercept = 1)
  
  
  
  ## Criacao plot segunda onda em adolescente 
  onda2_regiao_12_18_plot <- data.frame(idade_12_18_2onda_regiao_amostra[[2]][c(1,2,3)],
                                        idade_12_18_2onda_regiao_raio_x[[2]][c(1,2,3)],
                                        idade_12_18_2onda_regiao_tomo[[2]][c(1,2,3)],
                                        idade_12_18_2onda_regiao_vent[[2]][c(1,2,3)],
                                        idade_12_18_2onda_regiao_vent_inva[[2]][c(1,2,3)],
                                        idade_12_18_2onda_regiao_vent_n_inva[[2]][c(1,2,3)],
                                        idade_12_18_2onda_regiao_uti[[2]][c(1,2,3)],
                                        idade_12_18_2onda_regiao_obito[[2]][c(1,2,3)])
  names(onda2_regiao_12_18_plot) <- c("Amostra",
                                      "Amostra 2,5%",
                                      "Amostra 97,5",
                                      "Raio X",
                                      "Raio X 2,5%",
                                      "Raio X 97,5%",
                                      "Tomografia",
                                      "Tomografia 2,5%",
                                      "Tomografia 97,5",
                                      "Ventilatório",
                                      "Ventilatório 2,5%",
                                      "Ventilatório 97,5",
                                      "Invasivo",
                                      "Invasivo 2,5%",
                                      "Invasivo 97,5",
                                      "Não Invasivo",
                                      "Não Invasivo 2,5%",
                                      "Não Invasivo 97,5",
                                      "UTI",
                                      "UTI 2,5%",
                                      "UTI 97,5",
                                      "Letalidade",
                                      "Letalidade 2,5%",
                                      "Letalidade 97,5")
  
  onda2_regiao_12_18_plot$Regiao <- row.names(onda2_regiao_12_18_plot)
  onda2_regiao_12_18_plot <- subset(onda2_regiao_12_18_plot, onda2_regiao_12_18_plot$Regiao != "(Intercept)")
  onda2_regiao_12_18_plot[5,] <- 1
  onda2_regiao_12_18_plot$Regiao <- ifelse(onda2_regiao_12_18_plot$Regiao == 1, "REGIAONORDESTE", onda2_regiao_12_18_plot$Regiao)
  
  onda2_regiao_12_18_plot$Regiao <- factor(onda2_regiao_12_18_plot$Regiao, levels = c("REGIAONORDESTE",
                                                                                      "REGIAONORTE",
                                                                                      "REGIAOCENTRO-OESTE",
                                                                                      "REGIAOSUL",
                                                                                      "REGIAOSUDESTE"))	
  
  
  onda2_regiao_12_18_plot <- melt(onda2_regiao_12_18_plot, id.var = "Regiao")
  
  onda2_regiao_12_18_medias <- c("Amostra",
                                 "Raio X",
                                 "Tomografia",
                                 "Ventilatório",
                                 "Invasivo",
                                 "Não Invasivo",
                                 "UTI",
                                 "Letalidade")
  
  onda2_regiao_12_18_plot_medias <- subset(onda2_regiao_12_18_plot, onda2_regiao_12_18_plot$variable %in% onda2_regiao_12_18_medias)
  
  cc8 <- scales::seq_gradient_pal("black", "grey100", "Lab")(seq(0,1,length.out=6))
  g8 <- ggplot (onda2_regiao_12_18_plot_medias, aes(x=value, y=1, color=Regiao)) +
    geom_point(size = 6, alpha = 0.8)+
    facet_grid(variable ~.)+
    scale_colour_manual(values=cc8,
                        name = " ",
                        labels = c("Nordeste", "Norte", "Centro-Oeste", "Sul", "Sudeste"),
                        guide = "legend")+
    theme_bw()+
    theme(axis.title.y=element_blank(),
          axis.text.y=element_blank(),
          axis.ticks.y=element_blank())+
    xlab("Risco Relativo")+
    geom_vline(xintercept = 1)
  
```
  

```{r echo=FALSE, fig.height= 8, fig.width= 16}  
   
  
  #Juntando os graficos
  ggpubr::ggarrange(g5,g6,g7,g8,
                    labels = c("A", "B", "C", "D"), ncol = 4, 
                    legend = "bottom",common.legend = T)
  

```
